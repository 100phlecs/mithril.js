/*
Mithril v0.2.0
http://github.com/lhorie/mithril.js
(c) Leo Horie
License: MIT
*/
var m=function a(b,c){function d(a){return"function"==typeof a}function e(a){return"[object Object]"===P.call(a)}function f(a){return"[object String]"===P.call(a)}function g(a){K=a.document,L=a.location,N=a.cancelAnimationFrame||a.clearTimeout,M=a.requestAnimationFrame||a.setTimeout}function h(a,b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(e(a))return v(a,c);var g,h=null!=b&&e(b)&&!("tag"in b||"view"in b||"subtree"in b),i=h?b:{},j="class"in i?"class":"className",k={tag:"div",attrs:{}},l=[];if(!f(a))throw new Error("selector in m(selector, attrs, children) should be a string");for(;g=Q.exec(a);)if(""===g[1]&&g[2])k.tag=g[2];else if("#"===g[1])k.attrs.id=g[2];else if("."===g[1])l.push(g[2]);else if("["===g[3][0]){var m=R.exec(g[3]);k.attrs[m[1]]=m[3]||(m[2]?"":!0)}var n=h?c.slice(1):c;1===n.length&&O(n[0])?k.children=n[0]:k.children=n;for(var o in i)i.hasOwnProperty(o)&&(o===j&&null!=i[o]&&""!==i[o]?(l.push(i[o]),k.attrs[o]=""):k.attrs[o]=i[o]);return l.length&&(k.attrs[j]=l.join(" ")),k}function i(a,b){for(var c=0;c<a.length&&!b(a[c],c++););}function j(a,b){i(a,function(a,c){return(a=a&&a.attrs)&&null!=a.key&&b(a,c)})}function k(a){try{(null==a||null==a.toString())&&(a="")}catch(b){a=""}return a}function l(a,b,c,d){try{a.insertBefore(b,a.childNodes[c]||null),b.nodeValue=d}catch(e){}}function m(a,b,g,q,s,t,u,v,w,x,y){if(s=k(s),"retain"===s.subtree)return t;if(null==t||P.call(t)!==P.call(s)){if(null!=t)if(g&&g.nodes){var z=v-q,A=z+(O(s)?s:t.nodes).length;p(g.nodes.slice(z,A),g.slice(z,A))}else t.nodes&&p(t.nodes,t);t=new s.constructor,t.tag&&(t={}),t.nodes=[]}if(O(s)){for(var B=0;B<s.length;B++)O(s[B])&&(s=s.concat.apply([],s),B--);var C=[],D=t.length===s.length,E=0,F=1,G=2,H=3,I={},J=!1;j(t,function(a,b){J=!0,I[t[b].attrs.key]={action:F,index:b}});var L=0;if(j(s,function(){return i(s,function(a){(a=a&&a.attrs)&&null==a.key&&(a.key="__mithril__"+L++)}),1}),J){var M=s.length!=t.length;if(M||j(s,function(a,b){var c=t[b];return M=c&&c.attrs&&c.attrs.key!=a.key}),M){j(s,function(a,b){var c=a.key;I[c]?I[c]={action:H,index:b,from:I[c].index,element:t.nodes[I[c].index]||K.createElement("div")}:I[c]={action:G,index:b}});var N=[];for(var Q in I)N.push(I[Q]);var R=N.sort(n),U=new Array(t.length);U.nodes=t.nodes.slice(),i(R,function(b){if(b.action===F&&(p(t[b.index].nodes,t[b.index]),U.splice(b.index,1)),b.action===G){var c=K.createElement("div");c.key=s[b.index].attrs.key,a.insertBefore(c,a.childNodes[b.index]||null),U.splice(b.index,0,{attrs:{key:s[b.index].attrs.key},nodes:[c]}),U.nodes[b.index]=c}b.action===H&&(a.childNodes[b.index]!==b.element&&null!==b.element&&a.insertBefore(b.element,a.childNodes[b.index]||null),U[b.index]=t[b.from],U.nodes[b.index]=b.element)}),t=U}}var V=0;i(s,function(d){var e=m(a,b,t,v,d,t[V],u,v+E||E,w,x,y);e!==c&&(e.nodes.intact||(D=!1),E+=e.$trusted?(e.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:O(e)?e.length:1,t[V++]=e)}),D||(i(s,function(a,b){null!=t[b]&&C.push.apply(C,t[b].nodes)}),i(t.nodes,function(a,b){null!=a.parentNode&&C.indexOf(a)<0&&p([a],[t[b]])}),s.length<t.length&&(t.length=s.length),t.nodes=C)}else if(null!=s&&e(s)){for(var W=[],X=[];s.view;){var Y=s.view.$original||s.view,Z="diff"==h.redraw.strategy()&&t.views?t.views.indexOf(Y):-1,$=Z>-1?t.controllers[Z]:new(s.controller||T),_=s&&s.attrs&&s.attrs.key;if(s=0==ia||ha||t&&t.controllers&&t.controllers.indexOf($)>-1?s.view($):{tag:"placeholder"},"retain"===s.subtree)return t;null!=_&&(s.attrs||(s.attrs={}),s.attrs.key=_),$.onunload&&ea.push({controller:$,handler:$.onunload}),W.push(Y),X.push($)}if(!s.tag&&X.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");s.attrs||(s.attrs={}),t.attrs||(t.attrs={});var aa=Object.keys(s.attrs),ba=aa.length>("key"in s.attrs?1:0);if((s.tag!=t.tag||aa.sort().join()!=Object.keys(t.attrs).sort().join()||s.attrs.id!=t.attrs.id||s.attrs.key!=t.attrs.key||"all"==h.redraw.strategy()&&(!t.configContext||t.configContext.retain!==!0)||"diff"==h.redraw.strategy()&&t.configContext&&t.configContext.retain===!1)&&(t.nodes.length&&p(t.nodes),t.configContext&&d(t.configContext.onunload)&&t.configContext.onunload(),t.controllers))for(var $,B=0;$=t.controllers[B];B++)d($.onunload)&&$.onunload({preventDefault:T});if(!f(s.tag))return;var ca,da=0===t.nodes.length;if(s.attrs.xmlns?x=s.attrs.xmlns:"svg"===s.tag?x="http://www.w3.org/2000/svg":"math"===s.tag&&(x="http://www.w3.org/1998/Math/MathML"),da){if(ca=s.attrs.is?x===c?K.createElement(s.tag,s.attrs.is):K.createElementNS(x,s.tag,s.attrs.is):x===c?K.createElement(s.tag):K.createElementNS(x,s.tag),t={tag:s.tag,attrs:ba?o(ca,s.tag,s.attrs,{},x):s.attrs,children:null!=s.children&&s.children.length>0?m(ca,s.tag,c,c,s.children,t.children,!0,0,s.attrs.contenteditable?ca:w,x,y):s.children,nodes:[ca]},X.length){t.views=W,t.controllers=X;for(var $,B=0;$=X[B];B++)if($.onunload&&$.onunload.$old&&($.onunload=$.onunload.$old),ia&&$.onunload){var fa=$.onunload;$.onunload=T,$.onunload.$old=fa}}t.children&&!t.children.nodes&&(t.children.nodes=[]),"select"===s.tag&&"value"in s.attrs&&o(ca,s.tag,{value:s.attrs.value},{},x),a.insertBefore(ca,a.childNodes[v]||null)}else ca=t.nodes[0],ba&&o(ca,s.tag,s.attrs,t.attrs,x),t.children=m(ca,s.tag,c,c,s.children,t.children,!1,0,s.attrs.contenteditable?ca:w,x,y),t.nodes.intact=!0,X.length&&(t.views=W,t.controllers=X),u===!0&&null!=ca&&a.insertBefore(ca,a.childNodes[v]||null);if(d(s.attrs.config)){var ga=t.configContext=t.configContext||{},ja=function(a,b){return function(){return a.attrs.config.apply(a,b)}};y.push(ja(s,[ca,!da,ga,t]))}}else if(!d(s)){var C;0===t.nodes.length?(s.$trusted?C=r(a,v,s):(C=[K.createTextNode(s)],a.nodeName.match(S)||a.insertBefore(C[0],a.childNodes[v]||null)),t="string number boolean".indexOf(typeof s)>-1?new s.constructor(s):s,t.nodes=C):t.valueOf()!==s.valueOf()||u===!0?(C=t.nodes,w&&w===K.activeElement||(s.$trusted?(p(C,t),C=r(a,v,s)):"textarea"===b?a.value=s:w?w.innerHTML=s:((1===C[0].nodeType||C.length>1)&&(p(t.nodes,t),C=[K.createTextNode(s)]),l(a,C[0],v,s))),t=new s.constructor(s),t.nodes=C):t.nodes.intact=!0}return t}function n(a,b){return a.action-b.action||a.index-b.index}function o(a,b,c,f,g){for(var h in c){var i=c[h],j=f[h];if(h in f&&j===i)"value"===h&&"input"===b&&a.value!=i&&(a.value=i);else{f[h]=i;try{if("config"===h||"key"==h)continue;if(d(i)&&0===h.indexOf("on"))a[h]=s(i,a);else if("style"===h&&null!=i&&e(i)){for(var k in i)(null==j||j[k]!==i[k])&&(a.style[k]=i[k]);for(var k in j)k in i||(a.style[k]="")}else null!=g?"href"===h?a.setAttributeNS("http://www.w3.org/1999/xlink","href",i):"className"===h?a.setAttribute("class",i):a.setAttribute(h,i):h in a&&"list"!==h&&"style"!==h&&"form"!==h&&"type"!==h&&"width"!==h&&"height"!==h?("input"!==b||a[h]!==i)&&(a[h]=i):a.setAttribute(h,i)}catch(l){if(l.message.indexOf("Invalid argument")<0)throw l}}}return f}function p(a,b){for(var c=a.length-1;c>-1;c--)if(a[c]&&a[c].parentNode){try{a[c].parentNode.removeChild(a[c])}catch(d){}b=[].concat(b),b[c]&&q(b[c])}0!=a.length&&(a.length=0)}function q(a){if(a.configContext&&d(a.configContext.onunload)&&(a.configContext.onunload(),a.configContext.onunload=null),a.controllers)for(var b,c=0;b=a.controllers[c];c++)d(b.onunload)&&b.onunload({preventDefault:T});if(a.children)if(O(a.children))for(var e,c=0;e=a.children[c];c++)q(e);else a.children.tag&&q(a.children)}function r(a,b,c){var d=a.childNodes[b];if(d){var e=1!=d.nodeType,f=K.createElement("span");e?(a.insertBefore(f,d||null),f.insertAdjacentHTML("beforebegin",c),a.removeChild(f)):d.insertAdjacentHTML("beforebegin",c)}else a.insertAdjacentHTML("beforeend",c);for(var g=[];a.childNodes[b]!==d;)g.push(a.childNodes[b]),b++;return g}function s(a,b){return function(c){c=c||event,h.redraw.strategy("diff"),h.startComputation();try{return a.call(b,c)}finally{ja()}}}function t(a){var b=W.indexOf(a);return 0>b?W.push(a)-1:b}function u(a){var b=function(){return arguments.length&&(a=arguments[0]),a};return b.toJSON=function(){return a},b}function v(a,b){var c=function(){return(a.controller||T).apply(this,b)||this},d=function(c){for(var d=1;d<arguments.length;d++)b.push(arguments[d]);return a.view.apply(a,b?[c].concat(b):[c])};d.$original=a.view;var e={controller:c,view:d};return b[0]&&null!=b[0].key&&(e.attrs={key:b[0].key}),e}function w(){ca&&(ca(),ca=null);for(var a,b=0;a=Z[b];b++)if(_[b]){var c=$[b].controller&&$[b].controller.$$args?[_[b]].concat($[b].controller.$$args):[_[b]];h.render(a,$[b].view?$[b].view(_[b],c):"")}da&&(da(),da=null),aa=null,ba=new Date,h.redraw.strategy("diff")}function x(a){return a.slice(ma[h.route.mode].length)}function y(a,b,c){ka={};var d=c.indexOf("?");-1!==d&&(ka=C(c.substr(d+1,c.length)),c=c.substr(0,d));var e=Object.keys(b),f=e.indexOf(c);if(-1!==f)return h.mount(a,b[e[f]]),!0;for(var g in b){if(g===c)return h.mount(a,b[g]),!0;var i=new RegExp("^"+g.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(i.test(c))return c.replace(i,function(){for(var c=g.match(/:[^\/]+/g)||[],d=[].slice.call(arguments,1,-2),e=0,f=c.length;f>e;e++)ka[c[e].replace(/:|\./g,"")]=decodeURIComponent(d[e]);h.mount(a,b[g])}),!0}}function z(a){if(a=a||event,!a.ctrlKey&&!a.metaKey&&2!==a.which){a.preventDefault?a.preventDefault():a.returnValue=!1;for(var b=a.currentTarget||a.srcElement,c="pathname"===h.route.mode&&b.search?C(b.search.slice(1)):{};b&&"A"!=b.nodeName.toUpperCase();)b=b.parentNode;h.route(b[h.route.mode].slice(ma[h.route.mode].length),c)}}function A(){"hash"!=h.route.mode&&L.hash?L.hash=L.hash:b.scrollTo(0,0)}function B(a,b){var d={},f=[];for(var g in a){var h=b?b+"["+g+"]":g,i=a[g],j=(P.call(i),null===i?encodeURIComponent(h):e(i)?B(i,h):O(i)?i.reduce(function(a,b){return d[h]||(d[h]={}),d[h][b]?a:(d[h][b]=!0,a.concat(encodeURIComponent(h)+"="+encodeURIComponent(b)))},[]).join("&"):encodeURIComponent(h)+"="+encodeURIComponent(i));i!==c&&f.push(j)}return f.join("&")}function C(a){"?"===a.charAt(0)&&(a=a.substring(1));for(var b=a.split("&"),c={},d=0,e=b.length;e>d;d++){var f=b[d].split("="),g=decodeURIComponent(f[0]),h=2==f.length?decodeURIComponent(f[1]):null;null!=c[g]?(O(c[g])||(c[g]=[c[g]]),c[g].push(h)):c[g]=h}return c}function D(a){var b=t(a);p(a.childNodes,X[b]),X[b]=c}function E(a,b){var c=h.prop(b);return a.then(c),c.then=function(c,d){return E(a.then(c,d),b)},c["catch"]=c.then.bind(null,null),c}function F(a,b){function c(a){n=a||l,p.map(function(a){n===k&&a.resolve(o)||a.reject(o)})}function f(a,b,c,f){if((null!=o&&e(o)||d(o))&&d(a))try{var g=0;a.call(o,function(a){g++||(o=a,b())},function(a){g++||(o=a,c())})}catch(i){h.deferred.onerror(i),o=i,c()}else f()}function g(){var e;try{e=o&&o.then}catch(l){return h.deferred.onerror(l),o=l,n=j,g()}f(e,function(){n=i,g()},function(){n=j,g()},function(){try{n===i&&d(a)?o=a(o):n===j&&d(b)&&(o=b(o),n=i)}catch(g){return h.deferred.onerror(g),o=g,c()}o===m?(o=TypeError(),c()):f(e,function(){c(k)},c,function(){c(n===i&&k)})})}var i=1,j=2,k=3,l=4,m=this,n=0,o=0,p=[];m.promise={},m.resolve=function(a){return n||(o=a,n=i,g()),this},m.reject=function(a){return n||(o=a,n=j,g()),this},m.promise.then=function(a,b){var c=new F(a,b);return n===k?c.resolve(o):n===l?c.reject(o):p.push(c),c.promise}}function G(a){return a}function H(a){if(!a.dataType||"jsonp"!==a.dataType.toLowerCase()){var e=new b.XMLHttpRequest;if(e.open(a.method,a.url,!0,a.user,a.password),e.onreadystatechange=function(){4===e.readyState&&(e.status>=200&&e.status<300?a.onload({type:"load",target:e}):a.onerror({type:"error",target:e}))},a.serialize===JSON.stringify&&a.data&&"GET"!==a.method&&e.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.deserialize===JSON.parse&&e.setRequestHeader("Accept","application/json, text/*"),d(a.config)){var g=a.config(e,a);null!=g&&(e=g)}var h="GET"!==a.method&&a.data?a.data:"";if(h&&!f(h)&&h.constructor!=b.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return e.send(h),e}var i="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),j=K.createElement("script");b[i]=function(d){j.parentNode.removeChild(j),a.onload({type:"load",target:{responseText:d}}),b[i]=c},j.onerror=function(d){return j.parentNode.removeChild(j),a.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),b[i]=c,!1},j.onload=function(a){return!1},j.src=a.url+(a.url.indexOf("?")>0?"&":"?")+(a.callbackKey?a.callbackKey:"callback")+"="+i+"&"+B(a.data||{}),K.body.appendChild(j)}function I(a,b,c){if("GET"===a.method&&"jsonp"!=a.dataType){var d=a.url.indexOf("?")<0?"?":"&",e=B(b);a.url=a.url+(e?d+e:"")}else a.data=c(b);return a}function J(a,b){var c=a.match(/:[a-z]\w+/gi);if(c&&b)for(var d=0;d<c.length;d++){var e=c[d].slice(1);a=a.replace(c[d],b[e]),delete b[e]}return a}var K,L,M,N,O=Array.isArray||function(a){return"[object Array]"===P.call(a)},P={}.toString,Q=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,R=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,S=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,T=function(){};g(b);var U,V={appendChild:function(a){U===c&&(U=K.createElement("html")),K.documentElement&&K.documentElement!==a?K.replaceChild(a,K.documentElement):K.appendChild(a),this.childNodes=K.childNodes},insertBefore:function(a){this.appendChild(a)},childNodes:[]},W=[],X={};h.render=function(a,b,d){var e=[];if(!a)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var f=t(a),g=a===K,h=g||a===K.documentElement?V:a;g&&"html"!=b.tag&&(b={tag:"html",attrs:{},children:b}),X[f]===c&&p(h.childNodes),d===!0&&D(a),X[f]=m(h,null,c,c,b,X[f],!1,0,null,c,e);for(var i=0,j=e.length;j>i;i++)e[i]()},h.trust=function(a){return a=new String(a),a.$trusted=!0,a},h.prop=function(a){return(null!=a&&e(a)||d(a))&&d(a.then)?E(a):u(a)};var Y,Z=[],$=[],_=[],aa=null,ba=0,ca=null,da=null,ea=[],fa=16;h.component=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return v(a,b)},h.mount=h.module=function(a,b){if(!a)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var c=Z.indexOf(a);0>c&&(c=Z.length);for(var e,f=!1,g={preventDefault:function(){f=!0,ca=da=null}},i=0;e=ea[i];i++)e.handler.call(e.controller,g),e.controller.onunload=null;if(f)for(var e,i=0;e=ea[i];i++)e.controller.onunload=e.handler;else ea=[];if(_[c]&&d(_[c].onunload)&&_[c].onunload(g),!f){h.redraw.strategy("all"),h.startComputation(),Z[c]=a,arguments.length>2&&(b=subcomponent(b,[].slice.call(arguments,2)));var j=Y=b=b||{controller:T},k=b.controller||T,l=new k;return j===Y&&(_[c]=l,$[c]=b),ja(),_[c]}};var ga=!1,ha=!1;h.redraw=function(a){if(!ga){ga=!0,a&&(ha=!0);try{aa&&!a?(M===b.requestAnimationFrame||new Date-ba>fa)&&(aa>0&&N(aa),aa=M(w,fa)):(w(),aa=M(function(){aa=null},fa))}finally{ga=ha=!1}}},h.redraw.strategy=h.prop();var ia=0;h.startComputation=function(){ia++},h.endComputation=function(){ia=Math.max(ia-1,0),0===ia&&h.redraw()};var ja=function(){"none"==h.redraw.strategy()?(ia--,h.redraw.strategy("diff")):h.endComputation()};h.withAttr=function(a,b){return function(c){c=c||event;var d=c.currentTarget||this;b(a in d?d[a]:d.getAttribute(a))}};var ka,la,ma={pathname:"",hash:"#",search:"?"},na=T,oa=!1;return h.route=function(a,c,d,e){if(0===arguments.length)return la;if(3===arguments.length&&f(c)){na=function(b){var e=la=x(b);if(!y(a,d,e)){if(oa)throw new Error("Ensure the default route matches one of the routes defined in m.route");oa=!0,h.route(c,!0),oa=!1}};var g="hash"===h.route.mode?"onhashchange":"onpopstate";b[g]=function(){var a=L[h.route.mode];"pathname"===h.route.mode&&(a+=L.search),la!=x(a)&&na(a)},ca=A,b[g]()}else if(a.addEventListener||a.attachEvent)a.href=("pathname"!==h.route.mode?L.pathname:"")+ma[h.route.mode]+e.attrs.href,a.addEventListener?(a.removeEventListener("click",z),a.addEventListener("click",z)):(a.detachEvent("onclick",z),a.attachEvent("onclick",z));else if(f(a)){var i=la;la=a;var j=la.indexOf("?"),k=j>-1?C(la.slice(j+1)):{};for(var l in c)k[l]=c[l];var m=B(k),n=j>-1?la.slice(0,j):la;m&&(la=n+(-1===n.indexOf("?")?"?":"&")+m);var o=(3===arguments.length?d:c)===!0||i===a;b.history.pushState?(ca=A,da=function(){b.history[o?"replaceState":"pushState"](null,K.title,ma[h.route.mode]+la)},na(ma[h.route.mode]+la)):(L[h.route.mode]=la,na(ma[h.route.mode]+la))}},h.route.param=function(a){if(!ka)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return ka[a]},h.route.mode="search",h.route.buildQueryString=B,h.route.parseQueryString=C,h.deferred=function(){var a=new F;return a.promise=E(a.promise),a},h.deferred.onerror=function(a){if("[object Error]"===P.call(a)&&!a.constructor.toString().match(/ Error/))throw ia=0,a},h.sync=function(a){function b(a,b){return function(g){return f[a]=g,b||(c="reject"),0===--e&&(d.promise(f),d[c](f)),g}}var c="resolve",d=h.deferred(),e=a.length,f=new Array(e);if(a.length>0)for(var g=0;g<a.length;g++)a[g].then(b(g,!0),b(g,!1));else d.resolve([]);return d.promise},h.request=function(a){a.background!==!0&&h.startComputation();var b=new F,c=a.dataType&&"jsonp"===a.dataType.toLowerCase(),d=a.serialize=c?G:a.serialize||JSON.stringify,e=a.deserialize=c?G:a.deserialize||JSON.parse,f=c?function(a){return a.responseText}:a.extract||function(a){return 0===a.responseText.length&&e===JSON.parse?null:a.responseText};return a.method=(a.method||"GET").toUpperCase(),a.url=J(a.url,a.data),a=I(a,a.data,d),a.onload=a.onerror=function(c){try{c=c||event;var d=("load"===c.type?a.unwrapSuccess:a.unwrapError)||G,g=d(e(f(c.target,a)),c.target);"load"===c.type&&(O(g)&&a.type?i(g,function(b,c){g[c]=new a.type(b)}):a.type&&(g=new a.type(g))),b["load"===c.type?"resolve":"reject"](g)}catch(c){h.deferred.onerror(c),b.reject(c)}a.background!==!0&&h.endComputation()},H(a),b.promise=E(b.promise,a.initialValue),b.promise},h.deps=function(a){return g(b=a||b),b},h.deps.factory=a,h}("undefined"!=typeof window?window:{});"undefined"!=typeof module&&null!==module&&module.exports?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m});
//# sourceMappingURL=mithril.min.js.map